## 总体设计
这是一个解谜游戏，是玩家需要通过拖动窗口中的滑块找到可以“跑”的部分，以进入下一个关卡。以兰大生活为主题，画风是简洁的卡通画。

比如，屏幕上显示至公楼的卡通画，玩家发现至公楼由三块构成，左右两边可以向两端滑动，中间一个像火箭。于是玩家把两边拉开，点击中间，中间部分像火箭一样飞走，解谜成功。

## 谜题设计

### 第一章 迎新

1. 第一关，新手教程。校门口停着一辆车，教程提示需要找到可以跑的。玩家点击车，通过。
2. 第二关，新手教程。两棵树挂着几个横幅，最上面是生科院标语，最后画着一个骆驼，中间是信息院标语，“……bug……”，bug 是艺术字，形似骆驼身体，最下面是某院标语，其中有 11 之类的艺术字，像骆驼腿。教程提示“你可以移动一些东西”。玩家将骆驼的三部分拼在一起并点击，通过。
3. 第三关，新手教程。一辆校车，轮子被挂在两棵树中间的迎新横幅挡住了。教程提示“没有轮子的车跑不了”。玩家将横幅移开，点击校车，通过。

### 第二章 军训

1. 第一关。画面中一个踢正步的学生，天上一朵乌云，在下雨。玩家将乌云移开，点击学生，通过。
2. ... 后面的事情后面再想，前面也只是一个大概的思路。

## 实现思路

总体上思路是把数据和逻辑存在后端，这样可以方便增加谜题。

### 前端

前端只实现一个根据后端指令显示的框架，根据后端提供的信息将元素放在指定位置（根据 `vh` `em` 这种相对单位，或是前端先汇报屏幕的 `px` 大小，缩放由后端决定），及设置滑动范围。并在点击（点击应该是长按，防止误触，长按用监听 `mousedown` 事件和 `mouseup` 之间的间隔来实现）时向后端发送现在各个元素的位置。）

### 后端

后端需要一个文件存储各种谜题，包括关卡提示语、用到的图片以及初始位置、滑块起止坐标和通过条件，而不是硬编码每个在代码中，这样可拓展性高。  
比较难以实现的是通关条件，一个思路是在文件中以一定格式写出滑块间相对位置，代码中判断离这个相对位置差别不大就通过，另一个思路是用 Python 的 `eval` 执行在文件中写好的代码。

后端发给前端的关卡信息大概是这个格式。


## 前端要求

### 显示
1. 开始时向后端发送屏幕长宽像素，之后后端提供的所有位置均为绝对 px 坐标。
1. 所需页面内容
    1. 章节欢迎页面，在章节开始时显示后端发来的提示语。
    1. 关卡页面。主体根据后端提供的信息显示相应图片，并处理相关滑动逻辑。底部需要显示该章节的提示语啥的，顶部应该得有关卡名称。
1. 显示逻辑。后端发来的显示对象要被从底到上有正确的覆盖关系，注意写 zindex。

### 请求

指你们给我的请求。统一使用 post，以下只写请求内容。

1. 请求整个页面。需要发送现在的关卡编号，和整个显示区域的长宽。或者请求关卡欢迎页面。

```
POST /level

{
    level_id: ,
    width:  ,
    height: , 
}
```
```
POST /chapter

{
    chaptr_id: ,
}
```


位置验证信息。删了，不请求了，我直接一次性把通过条件也发过来。

### 存储

前端里存储现在到哪个关卡了，因为考虑到很多人只玩一次，没有必要给他建一个新账号。如果有人想再玩，可以存个 cookie，下次继续。这样所有响应都是没有副作用的，我就不需要搞多线程啥的了。

### 回应。

这是我给你们的回应。以 json 发送。

```
{
    message: ... , // 提示信息
    objects: [    // 每个对象的位置
        {
            position: {
                row: , // 图片左上角距离页面顶端高度
                col: , // 距离坐标高度
            },
            original_size: { // 给原始大小，用于判断手机应有的缩放和创建时缩放的关系。这样我们制作关卡时不用调整原始图片大小。
                width: ,
                height: ,
            },
            size: {
                width: , // 缩放后的图片宽
                height: , // 缩放后的图片高
            }
            pic_src: ... , // 图片路径
            // 本来打算做滑块，考虑到工作量，就改成全屏乱拖吧，有时间再改。
        }
        ...
    ],
    pass_condition: [ // 通过条件。若干组条件，任意一组条件内部全都满足
        [
            {
                first_object_id: , 
                second_object_id: , // 两个对象在 objects 里面的 id
                row_diff: {
                    min: ,
                    max: ,
                }, // 标准通过中，两个项目在竖直方向上的差，实际上当然要在这个正负几个像素都算通过。
                col_diff: {
                    min: ,
                    max: ,
                }, // 水平方向上的差。
            },
            ...
        ],
        ...
    ]
}
```

请求章节欢迎文字我直接返回文字，不搞 json。
